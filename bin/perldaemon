#!/bin/bash

declare -a LIBPATHS=(./lib ../lib /lib /usr/lib /usr/local/lib /opt/lib)

for path in ${LIBPATHS[@]}; do
        if [ -f $path/PerlDaemon/PerlDaemon.pl ]; then
                LIBDIR=$path
                break
        fi
done

start () perl -I$LIBDIR $LIBDIR/PerlDaemon/PerlDaemon.pl ./conf/perldaemon.conf
stop () kill $(cat ./run/perldaemon.pid)

case $1 in
	start)
	start
	;;

	stop)
	stop
	;;

	restart)
	stop
        start
	;;

	logrotate)
	kill -HUP $(cat ./run/perldaemon.pid)
	;;

	*)
	echo "Usage: $0 <start|stop|restart|logrotate>"
	exit 1
	;;
esac
